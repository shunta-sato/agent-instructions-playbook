<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tonemana Style Tile</title>
  <link rel="stylesheet" href="./style-tile.css" />
  <link id="patternTokens" rel="stylesheet" href="../tokens/neutral-minimal.tokens.css" />
</head>
<body>
  <header class="stack">
    <h1>Tone &amp; Manner Preview</h1>
    <p class="muted">Compare visual rules and writing style from catalog patterns.</p>
    <label class="pattern-picker" for="patternSelect">
      Pattern
      <select id="patternSelect"></select>
    </label>
  </header>

  <main class="grid">
    <section class="card stack">
      <h2>Components</h2>
      <div class="row">
        <button class="btn-primary">主要アクション</button>
        <button class="btn-secondary">副次アクション</button>
      </div>
      <label>入力項目
        <input type="text" placeholder="メールアドレス" />
      </label>
      <ul>
        <li>リスト項目 A</li>
        <li>リスト項目 B</li>
      </ul>
    </section>

    <section class="card stack">
      <h2>Typography</h2>
      <h3>見出しサンプル</h3>
      <p>本文サンプル。読みやすさと行間を確認します。<a href="#">リンク</a>の見え方も確認します。</p>
      <div class="alert" role="alert">
        エラー文例: 通信が不安定です。接続を確認して、もう一度お試しください。
      </div>
    </section>
  </main>

  <script>
    const DEFAULT_PATTERN = 'neutral-minimal';
    const PATTERNS = [
      'neutral-minimal',
      'warm-trust',
      'bold-energy',
      'calm-breath',
      'smart-premium',
      'nature-soft',
      'playful-pop'
    ];

    const patternTokens = document.getElementById('patternTokens');
    const patternSelect = document.getElementById('patternSelect');
    const params = new URLSearchParams(window.location.search);
    const initialPattern = params.get('pattern');
    const selectedPattern = PATTERNS.includes(initialPattern) ? initialPattern : DEFAULT_PATTERN;

    PATTERNS.forEach((patternId) => {
      const option = document.createElement('option');
      option.value = patternId;
      option.textContent = patternId;
      patternSelect.appendChild(option);
    });

    function updatePattern(patternId, shouldReplaceState = false) {
      patternTokens.href = `../tokens/${patternId}.tokens.css`;
      patternSelect.value = patternId;
      params.set('pattern', patternId);
      const nextUrl = `${window.location.pathname}?${params.toString()}`;
      if (shouldReplaceState) {
        window.history.replaceState({}, '', nextUrl);
      } else {
        window.history.pushState({}, '', nextUrl);
      }
    }

    patternSelect.addEventListener('change', () => {
      updatePattern(patternSelect.value);
    });

    updatePattern(selectedPattern, true);
  </script>
</body>
</html>
